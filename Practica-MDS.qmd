---
title: "Practica-MDS"
author: "Margalida Verd, Carla Martínez, Patricia Mateu"
format: html
editor: visual
---

Link al repositorio: [Repositorio Github](https://github.com/PatriciaMateu/Practica-MDS)

La práctica consiste en representar gráficamente (con solo 2 coordenadas principales) las matrices de similitud generadas por cada kernel coloreando los puntos de acuerdo al grupo de animales de acuerdo a su phylum.

```{r}
animals_PM <- read.table("ANIMALS-matrixPM.txt", header=FALSE)
animals_SP <- read.table("ANIMALS-matrixSP.txt", header=FALSE)
animals_VH <- read.table("ANIMALS-matrixVH.txt", header=FALSE)
animals_phylum <- read.table("fileListANIMAL_phylum.txt", header=FALSE)

str(animals_phylum)

```

```{r}
f <- function(x){sqrt(2*(1-x))}
dist_PM <- apply(animals_PM, MARGIN=c(1, 2), FUN= f)
dist_SP <- apply(animals_SP, MARGIN=c(1, 2), FUN= f)
dist_VH <- apply(animals_VH, MARGIN=c(1, 2), FUN= f)
```


```{r}
mds_VH <- cmdscale(dist_VH,k=2)
plot(mds_VH)
text(mds_VH, labels = animals_phylum$V2)
```

```{r}
# Load required packages
library(magrittr)
library(dplyr)
library(ggpubr)
# Cmpute MDS
mds <- dist_VH %>%
  dist() %>%          
  cmdscale() %>%
  as_tibble()
colnames(mds) <- c("Dim.1", "Dim.2")
# Plot MDS
ggscatter(mds, x = "Dim.1", y = "Dim.2",
          color = animals_phylum$V2,
          palette = "SunsetDark",
          size = 1,
          repel = T)
```

```{r}
ggplot(data = dist_VH, aes(color = animals_phylum$V2)) + geom_point()
```



